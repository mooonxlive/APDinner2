<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AP ROS BRUNCH Schedule</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #fafafa;
            color: #333;
            max-width: 100%;
            overflow-x: hidden;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            background-color: #fafafa;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            z-index: 10;
        }
        .title {
            font-size: 1.5rem;
            margin-bottom: 5px;
            font-weight: 500;
        }
        .time-display {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .countdown {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 15px;
        }
        .schedule {
            margin-top: 20px;
        }
        .item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #ddd;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        .item.past {
            opacity: 0.5;
        }
        .item.current {
            border-left: 4px solid #e84a5f;
            background-color: #fef9f9;
            box-shadow: 0 4px 8px rgba(232, 74, 95, 0.1);
        }
        .item-time {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }
        .item.current .item-time {
            color: #e84a5f;
        }
        .item-task {
            font-size: 1rem;
            line-height: 1.4;
        }
        .item.current .item-task {
            font-weight: 500;
        }
        .no-items {
            text-align: center;
            padding: 20px;
            color: #777;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="title">AP ROS BRUNCH</div>
        <div class="time-display" id="current-time">--:--:--</div>
        <div class="countdown" id="countdown">--</div>
    </div>
    
    <div class="schedule" id="schedule">
        <!-- Schedule items will be populated here via JavaScript -->
    </div>

    <script>
        // Schedule data
        const schedule = [
            { time: "10:00:00", task: "Cue: AP Lunch Playlist" },
            { time: "10:20:00", task: "Short Speech: Audrey Welcome & RDV" },
            { time: "10:25:00", task: "Short Speech: Imogen Intro & Open Brunch" },
            { time: "10:30:00", task: "AP Lunch Playlist ON" },
            { time: "10:30:00", task: "Start of BRUNCH" },
            { time: "10:30:00", task: "Start Performance: Mountain River Jump (first session ends at 1130)" },
            { time: "11:30:00", task: "Natasha Tontey video loop (30 minutes)" },
            { time: "12:00:00", task: "Start Performance: Mountain River Jump (second session ends at 1330)" },
            { time: "13:30:00", task: "End of Mountain River Jump" },
            { time: "14:10:00", task: "Bar Closes; Music Slow FadeOut" },
            { time: "14:30:00", task: "BRUNCH ENDS" }
        ];

        // Convert time string to Date object for today
        function timeToDate(timeStr) {
            // Handle the 12-hour format conversion (specifically for the brunch schedule)
            let timeString = timeStr;
            let hours = parseInt(timeString.split(':')[0]);
            
            // Standardize to 24-hour format
            if (timeString.includes('PM') && hours < 12) {
                hours += 12;
            } else if (timeString.includes('AM') && hours === 12) {
                hours = 0;
            }
            
            // Remove AM/PM indicators if they exist
            timeString = timeString.replace('AM', '').replace('PM', '').trim();
            
            // If it's in the format H:MM:SS, convert to HH:MM:SS
            const parts = timeString.split(':');
            if (parts[0].length === 1) {
                timeString = `0${timeString}`;
            }
            
            const [h, minutes, seconds] = timeString.split(':').map(Number);
            const date = new Date();
            
            date.setHours(hours || h, minutes, seconds || 0, 0);
            return date;
        }

        // Format time as HH:MM:SS
        function formatTime(date) {
            return date.toTimeString().substring(0, 8);
        }

        // Format countdown display
        function formatCountdown(seconds) {
            if (seconds < 0) return "Next event has passed";
            
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = Math.floor(seconds % 60);
            
            if (hours > 0) {
                return `${hours}h ${minutes}m ${secs}s until next`;
            } else if (minutes > 0) {
                return `${minutes}m ${secs}s until next`;
            } else {
                return `${secs}s until next`;
            }
        }

        // Find current and next items based on current time
        function getCurrentAndNextItems() {
            const now = new Date();
            
            // Convert schedule times to Date objects and sort by time
            const scheduleDates = schedule.map(item => ({
                time: timeToDate(item.time),
                originalTime: item.time,
                task: item.task
            })).sort((a, b) => a.time - b.time);
            
            let currentIndex = -1;
            
            // Find the current item index
            for (let i = scheduleDates.length - 1; i >= 0; i--) {
                if (now >= scheduleDates[i].time) {
                    currentIndex = i;
                    break;
                }
            }
            
            // Determine current and next item
            let currentItem = currentIndex >= 0 ? scheduleDates[currentIndex] : null;
            let nextItem = currentIndex < scheduleDates.length - 1 ? scheduleDates[currentIndex + 1] : null;
            
            return { currentItem, nextItem, scheduleDates };
        }

        // Update the DOM
        function updateDisplay() {
            const now = new Date();
            const timeDisplay = document.getElementById('current-time');
            const countdownDisplay = document.getElementById('countdown');
            const scheduleContainer = document.getElementById('schedule');
            
            // Update current time
            timeDisplay.textContent = formatTime(now);
            
            // Get current and next items
            const { currentItem, nextItem, scheduleDates } = getCurrentAndNextItems();
            
            // Update countdown
            if (nextItem) {
                const secondsToNext = (nextItem.time - now) / 1000;
                countdownDisplay.textContent = formatCountdown(secondsToNext);
            } else {
                countdownDisplay.textContent = "All events completed";
            }
            
            // Rebuild schedule display
            scheduleContainer.innerHTML = '';
            
            if (scheduleDates.length === 0) {
                scheduleContainer.innerHTML = '<div class="no-items">No schedule items found</div>';
                return;
            }
            
            scheduleDates.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'item';
                
                if (currentItem && item.originalTime === currentItem.originalTime && item.task === currentItem.task) {
                    itemElement.classList.add('current');
                } else if (item.time < now) {
                    itemElement.classList.add('past');
                }
                
                // Format the time nicely for display (just HH:MM format)
                let displayTime = item.originalTime;
                if (displayTime.includes(':')) {
                    const timeParts = displayTime.split(':');
                    displayTime = timeParts[0] + ':' + timeParts[1];
                }
                
                const timeElement = document.createElement('div');
                timeElement.className = 'item-time';
                timeElement.textContent = displayTime;
                
                const taskElement = document.createElement('div');
                taskElement.className = 'item-task';
                taskElement.textContent = item.task;
                
                itemElement.appendChild(timeElement);
                itemElement.appendChild(taskElement);
                scheduleContainer.appendChild(itemElement);
            });
        }

        // Initialize and update every second
        updateDisplay();
        setInterval(updateDisplay, 1000);
    </script>
</body>
</html>
